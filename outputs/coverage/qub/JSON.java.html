<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSON.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCo Coverage Report</a> &gt; <a href="index.source.html" class="el_package">qub</a> &gt; <span class="el_source">JSON.java</span></div><h1>JSON.java</h1><pre class="source lang-java linenums">package qub;

/**
 * A collection of functions for interacting with JSON content.
 */
public interface JSON
{
    static String thePropertyNamed(String propertyName)
    {
<span class="fc" id="L10">        return &quot;the property named &quot; + Strings.escapeAndQuote(propertyName);</span>
    }

    static String getWrongTypeExceptionMessage(JSONSegment value, Iterable&lt;java.lang.Class&lt;? extends JSONSegment&gt;&gt; expectedTypes, String valueName)
    {
<span class="fc" id="L15">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="fc" id="L16">        PreCondition.assertNotNullAndNotEmpty(expectedTypes, &quot;expectedTypes&quot;);</span>
<span class="fc" id="L17">        PreCondition.assertNotNullAndNotEmpty(valueName, &quot;valueName&quot;);</span>

<span class="fc" id="L19">        return &quot;Expected &quot; + valueName + &quot; to be a &quot; + English.orList(expectedTypes.map(Types::getTypeName)) + &quot;, but was a &quot; + Types.getTypeName(value) + &quot; instead.&quot;;</span>
    }

    static &lt;T extends JSONSegment&gt; Result&lt;T&gt; as(JSONSegment value, java.lang.Class&lt;T&gt; type, String valueName)
    {
<span class="fc" id="L24">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="fc" id="L25">        PreCondition.assertNotNull(type, &quot;type&quot;);</span>
<span class="fc" id="L26">        PreCondition.assertNotNullAndNotEmpty(valueName, &quot;valueName&quot;);</span>

<span class="fc" id="L28">        final T typedValue = Types.as(value, type);</span>
<span class="fc bfc" id="L29" title="All 2 branches covered.">        return typedValue == null</span>
<span class="fc" id="L30">            ? Result.error(new WrongTypeException(JSON.getWrongTypeExceptionMessage(value, Iterable.create(type), valueName)))</span>
<span class="fc" id="L31">            : Result.success(typedValue);</span>
    }

    static &lt;T extends JSONSegment&gt; Result&lt;T&gt; as(JSONSegment value, java.lang.Class&lt;T&gt; type)
    {
<span class="fc" id="L36">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="fc" id="L37">        PreCondition.assertNotNull(type, &quot;type&quot;);</span>

<span class="fc" id="L39">        return JSON.as(value, type, &quot;value&quot;);</span>
    }

    static &lt;T extends JSONSegment&gt; Result&lt;T&gt; asOrNull(JSONSegment value, java.lang.Class&lt;T&gt; type, String valueName)
    {
<span class="fc" id="L44">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="fc" id="L45">        PreCondition.assertNotNull(type, &quot;type&quot;);</span>
<span class="fc" id="L46">        PreCondition.assertNotNullAndNotEmpty(valueName, &quot;valueName&quot;);</span>

<span class="fc" id="L48">        return JSON.as(value, type)</span>
<span class="fc" id="L49">            .catchError(WrongTypeException.class, () -&gt; JSON.as(value, JSONNull.class).await())</span>
<span class="fc" id="L50">            .convertError(WrongTypeException.class, () -&gt; new WrongTypeException(JSON.getWrongTypeExceptionMessage(value, Iterable.create(type, JSONNull.class), valueName)));</span>
    }

    static &lt;T extends JSONSegment&gt; Result&lt;T&gt; asOrNull(JSONSegment value, java.lang.Class&lt;T&gt; type)
    {
<span class="nc" id="L55">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="nc" id="L56">        PreCondition.assertNotNull(type, &quot;type&quot;);</span>

<span class="nc" id="L58">        return JSON.asOrNull(value, type, &quot;value&quot;);</span>
    }

    static Boolean toBooleanOrNull(JSONBoolean segment)
    {
<span class="fc bfc" id="L63" title="All 2 branches covered.">        return segment == null ? null : segment.getValue();</span>
    }

    static Double toNumberOrNull(JSONNumber segment)
    {
<span class="fc bfc" id="L68" title="All 2 branches covered.">        return segment == null ? null : segment.getValue();</span>
    }

    static String toStringOrNull(JSONString segment)
    {
<span class="fc bfc" id="L73" title="All 2 branches covered.">        return segment == null ? null : segment.getValue();</span>
    }

    /**
     * Parse a JSONSegment from the provided text.
     * @param text The text to parse into a JSONSegment.
     * @return The parsed JSONSegment.
     */
    static Result&lt;JSONSegment&gt; parse(String text)
    {
<span class="fc" id="L83">        PreCondition.assertNotNullAndNotEmpty(text, &quot;text&quot;);</span>

<span class="fc" id="L85">        return JSON.parse(Strings.iterable(text));</span>
    }

    /**
     * Parse a JSONSegment from the provided characters.
     * @param characters The characters to parse into a JSONSegment.
     * @return The parsed JSONSegment.
     */
    static Result&lt;JSONSegment&gt; parse(Iterable&lt;Character&gt; characters)
    {
<span class="fc" id="L95">        PreCondition.assertNotNullAndNotEmpty(characters, &quot;characters&quot;);</span>

<span class="fc" id="L97">        return JSON.parse(characters.iterate());</span>
    }

    /**
     * Parse a JSONSegment from the provided characters.
     * @param characters The characters to parse into a JSONSegment.
     * @return The parsed JSONSegment.
     */
    static Result&lt;JSONSegment&gt; parse(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L107">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L109">        return JSON.parse(JSON.createTokenizer(characters));</span>
    }

    /**
     * Parse a JSONSegment from the provided JSONTokenizer.
     * @param tokenizer The tokenizer that produces JSONTokens.
     * @return The parsed JSONSegment.
     */
    static Result&lt;JSONSegment&gt; parse(JSONTokenizer tokenizer)
    {
<span class="fc" id="L119">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc" id="L121">        return Result.create(() -&gt;</span>
        {
<span class="fc" id="L123">            JSON.ensureHasStarted(tokenizer);</span>

<span class="fc bfc" id="L125" title="All 2 branches covered.">            if (!tokenizer.hasCurrent())</span>
            {
<span class="fc" id="L127">                throw new ParseException(&quot;No JSON tokens found.&quot;);</span>
            }

            JSONSegment result;
<span class="fc bfc" id="L131" title="All 7 branches covered.">            switch (tokenizer.getCurrent().getType())</span>
            {
                case LeftCurlyBracket:
<span class="fc" id="L134">                    result = JSON.parseObject(tokenizer).await();</span>
<span class="fc" id="L135">                    break;</span>

                case LeftSquareBracket:
<span class="fc" id="L138">                    result = JSON.parseArray(tokenizer).await();</span>
<span class="fc" id="L139">                    break;</span>

                case Boolean:
<span class="fc bfc" id="L142" title="All 2 branches covered.">                    result = JSONBoolean.get(JSONToken.falseToken != JSON.takeCurrent(tokenizer));</span>
<span class="fc" id="L143">                    break;</span>

                case Null:
<span class="fc" id="L146">                    result = JSONNull.segment;</span>
<span class="fc" id="L147">                    JSON.next(tokenizer);</span>
<span class="fc" id="L148">                    break;</span>

                case Number:
<span class="fc" id="L151">                    result = JSONNumber.get(JSON.takeCurrent(tokenizer).getText());</span>
<span class="fc" id="L152">                    break;</span>

                case QuotedString:
<span class="fc" id="L155">                    result = JSONString.getFromQuoted(JSON.takeCurrent(tokenizer).getText());</span>
<span class="fc" id="L156">                    break;</span>

                default:
<span class="fc" id="L159">                    throw new ParseException(&quot;Unexpected JSON token: &quot; + tokenizer.getCurrent());</span>
            }

<span class="fc" id="L162">            PostCondition.assertNotNull(result, &quot;result&quot;);</span>

<span class="fc" id="L164">            return result;</span>
        });
    }

    /**
     * Parse a JSONObject from the provided text.
     * @param text The text to parse into a JSONObject.
     * @return The parsed JSONObject.
     */
    static Result&lt;JSONObject&gt; parseObject(String text)
    {
<span class="fc" id="L175">        PreCondition.assertNotNullAndNotEmpty(text, &quot;text&quot;);</span>

<span class="fc" id="L177">        return JSON.parseObject(Strings.iterable(text));</span>
    }

    /**
     * Parse a JSONObject from the provided characters.
     * @param characters The characters to parse into a JSONObject.
     * @return The parsed JSONObject.
     */
    static Result&lt;JSONObject&gt; parseObject(Iterable&lt;Character&gt; characters)
    {
<span class="fc" id="L187">        PreCondition.assertNotNullAndNotEmpty(characters, &quot;characters&quot;);</span>

<span class="fc" id="L189">        return JSON.parseObject(characters.iterate());</span>
    }

    /**
     * Parse a JSONObject from the provided characters.
     * @param characters The characters to parse into a JSONObject.
     * @return The parsed JSONObject.
     */
    static Result&lt;JSONObject&gt; parseObject(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L199">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L201">        return JSON.parseObject(JSON.createTokenizer(characters));</span>
    }

    /**
     * Parse a JSONObject from the provided JSONTokenizer.
     * @param tokenizer The tokenizer that produces JSONTokens.
     * @return The parsed JSONObject.
     */
    static Result&lt;JSONObject&gt; parseObject(JSONTokenizer tokenizer)
    {
<span class="fc" id="L211">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>
<span class="fc" id="L212">        PreCondition.assertTrue(tokenizer.hasCurrent(), &quot;tokenizer.hasCurrent()&quot;);</span>
<span class="fc" id="L213">        PreCondition.assertEqual(JSONToken.leftCurlyBracket, tokenizer.getCurrent(), &quot;tokenizer.getCurrent()&quot;);</span>

<span class="fc" id="L215">        return Result.create(() -&gt;</span>
        {
<span class="fc" id="L217">            final JSONToken leftCurlyBracket = JSON.takeCurrent(tokenizer);</span>

<span class="fc" id="L219">            final List&lt;JSONProperty&gt; properties = List.create();</span>
<span class="fc" id="L220">            JSONToken rightCurlyBracket = null;</span>
<span class="fc" id="L221">            boolean expectProperty = true;</span>
<span class="fc bfc" id="L222" title="All 4 branches covered.">            while (tokenizer.hasCurrent() &amp;&amp; rightCurlyBracket == null)</span>
            {
<span class="fc bfc" id="L224" title="All 4 branches covered.">                switch (tokenizer.getCurrent().getType())</span>
                {
                    case QuotedString:
<span class="fc bfc" id="L227" title="All 2 branches covered.">                        if (!expectProperty)</span>
                        {
<span class="fc" id="L229">                            throw new ParseException(&quot;Expected object property separator (',') or right curly bracket ('}').&quot;);</span>
                        }
<span class="fc" id="L231">                        properties.add(JSON.parseObjectProperty(tokenizer).await());</span>
<span class="fc" id="L232">                        expectProperty = false;</span>
<span class="fc" id="L233">                        break;</span>

                    case Comma:
<span class="fc bfc" id="L236" title="All 2 branches covered.">                        if (expectProperty)</span>
                        {
<span class="fc bfc" id="L238" title="All 2 branches covered.">                            if (properties.any())</span>
                            {
<span class="fc" id="L240">                                throw new ParseException(&quot;Expected quoted-string object property name.&quot;);</span>
                            }
                            else
                            {
<span class="fc" id="L244">                                throw new ParseException(&quot;Expected quoted-string object property name or right curly bracket ('}').&quot;);</span>
                            }
                        }
<span class="fc" id="L247">                        JSON.next(tokenizer);</span>
<span class="fc" id="L248">                        expectProperty = true;</span>
<span class="fc" id="L249">                        break;</span>

                    case RightCurlyBracket:
<span class="fc bfc" id="L252" title="All 4 branches covered.">                        if (properties.any() &amp;&amp; expectProperty)</span>
                        {
<span class="fc" id="L254">                            throw new ParseException(&quot;Expected quoted-string object property name.&quot;);</span>
                        }
<span class="fc" id="L256">                        rightCurlyBracket = JSON.takeCurrent(tokenizer);</span>
<span class="fc" id="L257">                        break;</span>

                    default:
<span class="fc bfc" id="L260" title="All 2 branches covered.">                        if (properties.any())</span>
                        {
<span class="fc bfc" id="L262" title="All 2 branches covered.">                            if (expectProperty)</span>
                            {
<span class="fc" id="L264">                                throw new ParseException(&quot;Expected quoted-string object property name.&quot;);</span>
                            }
                            else
                            {
<span class="fc" id="L268">                                throw new ParseException(&quot;Expected object property separator (',') or right curly bracket ('}').&quot;);</span>
                            }
                        }
                        else
                        {
<span class="fc" id="L273">                            throw new ParseException(&quot;Expected quoted-string object property name or right curly bracket ('}').&quot;);</span>
                        }
                }
            }

<span class="fc bfc" id="L278" title="All 4 branches covered.">            if (properties.any() &amp;&amp; expectProperty)</span>
            {
<span class="fc" id="L280">                throw new ParseException(&quot;Missing object property.&quot;);</span>
            }
<span class="fc bfc" id="L282" title="All 2 branches covered.">            else if (rightCurlyBracket == null)</span>
            {
<span class="fc" id="L284">                throw new ParseException(&quot;Missing object right curly bracket ('}').&quot;);</span>
            }

<span class="fc" id="L287">            return JSONObject.create(properties);</span>
        });
    }

    /**
     * Parse a JSONObjectProperty from the provided text.
     * @param text The text to parse into a JSONObjectProperty.
     * @return The parsed JSONObjectProperty.
     */
    static Result&lt;JSONProperty&gt; parseObjectProperty(String text)
    {
<span class="fc" id="L298">        PreCondition.assertNotNullAndNotEmpty(text, &quot;text&quot;);</span>

<span class="fc" id="L300">        return JSON.parseObjectProperty(Strings.iterable(text));</span>
    }

    /**
     * Parse a JSONObjectProperty from the provided characters.
     * @param characters The characters to parse into a JSONObjectProperty.
     * @return The parsed JSONObjectProperty.
     */
    static Result&lt;JSONProperty&gt; parseObjectProperty(Iterable&lt;Character&gt; characters)
    {
<span class="fc" id="L310">        PreCondition.assertNotNullAndNotEmpty(characters, &quot;characters&quot;);</span>

<span class="fc" id="L312">        return JSON.parseObjectProperty(characters.iterate());</span>
    }

    /**
     * Parse a JSONObjectProperty from the provided characters.
     * @param characters The characters to parse into a JSONObjectProperty.
     * @return The parsed JSONObjectProperty.
     */
    static Result&lt;JSONProperty&gt; parseObjectProperty(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L322">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L324">        return JSON.parseObjectProperty(JSON.createTokenizer(characters));</span>
    }

    /**
     * Parse a JSONObjectProperty from the provided JSONTokenizer.
     * @param tokenizer The tokenizer that produces JSONTokens.
     * @return The parsed JSONObjectProperty.
     */
    static Result&lt;JSONProperty&gt; parseObjectProperty(JSONTokenizer tokenizer)
    {
<span class="fc" id="L334">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>
<span class="fc" id="L335">        PreCondition.assertTrue(tokenizer.hasCurrent(), &quot;tokenizer.hasCurrent()&quot;);</span>
<span class="fc" id="L336">        PreCondition.assertEqual(JSONTokenType.QuotedString, tokenizer.getCurrent().getType(), &quot;tokenizer.getCurrent().getType()&quot;);</span>

<span class="fc" id="L338">        return Result.create(() -&gt;</span>
        {
<span class="fc" id="L340">            final String quotedPropertyName = JSON.takeCurrent(tokenizer).getText();</span>
<span class="fc" id="L341">            final String propertyName = quotedPropertyName.substring(1, quotedPropertyName.length() - 1);</span>

<span class="fc bfc" id="L343" title="All 2 branches covered.">            if (!tokenizer.hasCurrent())</span>
            {
<span class="fc" id="L345">                throw new ParseException(&quot;Missing object property name and value separator (':').&quot;);</span>
            }
<span class="fc bfc" id="L347" title="All 2 branches covered.">            else if (tokenizer.getCurrent().getType() != JSONTokenType.Colon)</span>
            {
<span class="fc" id="L349">                throw new ParseException(&quot;Expected object property name and value separator (':').&quot;);</span>
            }

            JSONSegment propertyValue;
<span class="fc bfc" id="L353" title="All 2 branches covered.">            if (!JSON.next(tokenizer))</span>
            {
<span class="fc" id="L355">                throw new ParseException(&quot;Missing object property value.&quot;);</span>
            }
            else
            {
<span class="fc bfc" id="L359" title="All 3 branches covered.">                switch (tokenizer.getCurrent().getType())</span>
                {
                    case Comma:
<span class="fc" id="L362">                        throw new ParseException(&quot;Expected object property value.&quot;);</span>

                    case Boolean:
                    case Null:
                    case Number:
                    case QuotedString:
                    case LeftCurlyBracket:
                    case LeftSquareBracket:
<span class="fc" id="L370">                        propertyValue = JSON.parse(tokenizer).await();</span>
<span class="fc" id="L371">                        break;</span>

                    default:
<span class="fc" id="L374">                        throw new ParseException(&quot;Unexpected object property value token: &quot; + Strings.escapeAndQuote(tokenizer.getCurrent()));</span>
                }
            }

<span class="fc" id="L378">            return JSONProperty.create(propertyName, propertyValue);</span>
        });
    }

    /**
     * Parse a JSONArray from the provided text.
     * @param text The text to parse into a JSONArray.
     * @return The parsed JSONArray.
     */
    static Result&lt;JSONArray&gt; parseArray(String text)
    {
<span class="fc" id="L389">        PreCondition.assertNotNullAndNotEmpty(text, &quot;text&quot;);</span>

<span class="fc" id="L391">        return JSON.parseArray(Strings.iterable(text));</span>
    }

    /**
     * Parse a JSONArray from the provided characters.
     * @param characters The characters to parse into a JSONArray.
     * @return The parsed JSONArray.
     */
    static Result&lt;JSONArray&gt; parseArray(Iterable&lt;Character&gt; characters)
    {
<span class="fc" id="L401">        PreCondition.assertNotNullAndNotEmpty(characters, &quot;characters&quot;);</span>

<span class="fc" id="L403">        return JSON.parseArray(characters.iterate());</span>
    }

    /**
     * Parse a JSONArray from the provided characters.
     * @param characters The characters to parse into a JSONArray.
     * @return The parsed JSONArray.
     */
    static Result&lt;JSONArray&gt; parseArray(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L413">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L415">        return JSON.parseArray(JSON.createTokenizer(characters));</span>
    }

    /**
     * Parse a JSONArray from the provided JSONTokenizer.
     * @param tokenizer The tokenizer that produces JSONTokens.
     * @return The parsed JSONArray.
     */
    static Result&lt;JSONArray&gt; parseArray(JSONTokenizer tokenizer)
    {
<span class="fc" id="L425">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>
<span class="fc" id="L426">        PreCondition.assertTrue(tokenizer.hasCurrent(), &quot;tokenizer.hasCurrent()&quot;);</span>
<span class="fc" id="L427">        PreCondition.assertEqual(JSONToken.leftSquareBracket, tokenizer.getCurrent(), &quot;tokenizer.getCurrent()&quot;);</span>

<span class="fc" id="L429">        return Result.create(() -&gt;</span>
        {
<span class="fc" id="L431">            final JSONToken leftSquareBracket = JSON.takeCurrent(tokenizer);</span>

<span class="fc" id="L433">            final List&lt;JSONSegment&gt; elements = List.create();</span>

<span class="fc" id="L435">            JSONToken rightSquareBracket = null;</span>
<span class="fc" id="L436">            boolean expectElement = true;</span>
<span class="fc bfc" id="L437" title="All 4 branches covered.">            while (tokenizer.hasCurrent() &amp;&amp; rightSquareBracket == null)</span>
            {
<span class="fc bfc" id="L439" title="All 4 branches covered.">                switch (tokenizer.getCurrent().getType())</span>
                {
                    case Boolean:
                    case Null:
                    case Number:
                    case QuotedString:
                    case LeftCurlyBracket:
                    case LeftSquareBracket:
<span class="fc bfc" id="L447" title="All 2 branches covered.">                        if (!expectElement)</span>
                        {
<span class="fc" id="L449">                            throw new ParseException(&quot;Expected array element separator (',') or right square bracket (']').&quot;);</span>
                        }
<span class="fc" id="L451">                        elements.add(JSON.parse(tokenizer).await());</span>
<span class="fc" id="L452">                        expectElement = false;</span>
<span class="fc" id="L453">                        break;</span>

                    case Comma:
<span class="fc bfc" id="L456" title="All 2 branches covered.">                        if (expectElement)</span>
                        {
<span class="fc" id="L458">                            throw new ParseException(&quot;Expected array element.&quot;);</span>
                        }
<span class="fc" id="L460">                        JSON.next(tokenizer);</span>
<span class="fc" id="L461">                        expectElement = true;</span>
<span class="fc" id="L462">                        break;</span>

                    case RightSquareBracket:
<span class="fc bfc" id="L465" title="All 4 branches covered.">                        if (elements.any() &amp;&amp; expectElement)</span>
                        {
<span class="fc" id="L467">                            throw new ParseException(&quot;Expected array element.&quot;);</span>
                        }
<span class="fc" id="L469">                        rightSquareBracket = JSON.takeCurrent(tokenizer);</span>
<span class="fc" id="L470">                        expectElement = false;</span>
<span class="fc" id="L471">                        break;</span>

                    default:
<span class="fc" id="L474">                        throw new ParseException(&quot;Unexpected array element token: &quot; + Strings.escapeAndQuote(tokenizer.getCurrent()));</span>
                }
            }

<span class="fc bfc" id="L478" title="All 4 branches covered.">            if (elements.any() &amp;&amp; expectElement)</span>
            {
<span class="fc" id="L480">                throw new ParseException(&quot;Missing array element.&quot;);</span>
            }
<span class="fc bfc" id="L482" title="All 2 branches covered.">            else if (rightSquareBracket == null)</span>
            {
<span class="fc" id="L484">                throw new ParseException(&quot;Missing array right square bracket (']').&quot;);</span>
            }

<span class="fc" id="L487">            return JSONArray.create(elements);</span>
        });
    }

    static JSONTokenizer createTokenizer(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L493">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L495">        final JSONTokenizer result = JSONTokenizer.create(characters);</span>
<span class="fc" id="L496">        JSON.next(result);</span>

<span class="fc" id="L498">        PostCondition.assertNotNull(result, &quot;result&quot;);</span>
<span class="fc" id="L499">        PostCondition.assertTrue(result.hasStarted(), &quot;result.hasStarted()&quot;);</span>

<span class="fc" id="L501">        return result;</span>
    }

    static boolean shouldSkipCurrentToken(JSONTokenizer tokenizer)
    {
<span class="fc" id="L506">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>
<span class="fc" id="L507">        PreCondition.assertTrue(tokenizer.hasCurrent(), &quot;tokenizer.hasCurrent()&quot;);</span>

        boolean result;
<span class="fc bfc" id="L510" title="All 2 branches covered.">        switch (tokenizer.getCurrent().getType())</span>
        {
            case BlockComment:
            case LineComment:
            case NewLine:
            case Whitespace:
<span class="fc" id="L516">                result = true;</span>
<span class="fc" id="L517">                break;</span>

            default:
<span class="fc" id="L520">                result = false;</span>
                break;
        }

<span class="fc" id="L524">        return result;</span>
    }

    static boolean next(JSONTokenizer tokenizer)
    {
<span class="fc" id="L529">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc" id="L531">        boolean result = tokenizer.next();</span>
<span class="fc bfc" id="L532" title="All 4 branches covered.">        while (result &amp;&amp; JSON.shouldSkipCurrentToken(tokenizer))</span>
        {
<span class="fc" id="L534">            result = tokenizer.next();</span>
        }

<span class="fc" id="L537">        return result;</span>
    }

    static void ensureHasStarted(JSONTokenizer tokenizer)
    {
<span class="fc" id="L542">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc bfc" id="L544" title="All 6 branches covered.">        if (!tokenizer.hasStarted() || (tokenizer.hasCurrent() &amp;&amp; JSON.shouldSkipCurrentToken(tokenizer)))</span>
        {
<span class="fc" id="L546">            JSON.next(tokenizer);</span>
        }

<span class="fc" id="L549">        PostCondition.assertTrue(tokenizer.hasStarted(), &quot;tokenizer.hasStarted()&quot;);</span>
<span class="fc" id="L550">    }</span>

    static JSONToken takeCurrent(JSONTokenizer tokenizer)
    {
<span class="fc" id="L554">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>
<span class="fc" id="L555">        PreCondition.assertTrue(tokenizer.hasCurrent(), &quot;tokenizer.hasCurrent()&quot;);</span>

<span class="fc" id="L557">        final JSONToken result = tokenizer.getCurrent();</span>
<span class="fc" id="L558">        JSON.next(tokenizer);</span>

<span class="fc" id="L560">        return result;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.4.201905082037</span></div></body></html>