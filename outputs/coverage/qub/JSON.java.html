<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>JSON.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCo Coverage Report</a> &gt; <a href="index.source.html" class="el_package">qub</a> &gt; <span class="el_source">JSON.java</span></div><h1>JSON.java</h1><pre class="source lang-java linenums">package qub;

/**
 * A collection of functions for interacting with JSON content.
 */
public interface JSON
{
    static String thePropertyNamed(String propertyName)
    {
<span class="fc" id="L10">        return &quot;the property named &quot; + Strings.escapeAndQuote(propertyName);</span>
    }

    static String getWrongTypeExceptionMessage(JSONSegment value, Iterable&lt;java.lang.Class&lt;? extends JSONSegment&gt;&gt; expectedTypes, String valueName)
    {
<span class="fc" id="L15">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="fc" id="L16">        PreCondition.assertNotNullAndNotEmpty(expectedTypes, &quot;expectedTypes&quot;);</span>
<span class="fc" id="L17">        PreCondition.assertNotNullAndNotEmpty(valueName, &quot;valueName&quot;);</span>

<span class="fc" id="L19">        return &quot;Expected &quot; + valueName + &quot; to be a &quot; + English.orList(expectedTypes.map(Types::getTypeName)) + &quot;, but was a &quot; + Types.getTypeName(value) + &quot; instead.&quot;;</span>
    }

    static &lt;T extends JSONSegment&gt; Result&lt;T&gt; as(JSONSegment value, java.lang.Class&lt;T&gt; type, String valueName)
    {
<span class="fc" id="L24">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="fc" id="L25">        PreCondition.assertNotNull(type, &quot;type&quot;);</span>
<span class="fc" id="L26">        PreCondition.assertNotNullAndNotEmpty(valueName, &quot;valueName&quot;);</span>

<span class="fc" id="L28">        final T typedValue = Types.as(value, type);</span>
<span class="fc bfc" id="L29" title="All 2 branches covered.">        return typedValue == null</span>
<span class="fc" id="L30">            ? Result.error(new WrongTypeException(JSON.getWrongTypeExceptionMessage(value, Iterable.create(type), valueName)))</span>
<span class="fc" id="L31">            : Result.success(typedValue);</span>
    }

    static &lt;T extends JSONSegment&gt; Result&lt;T&gt; as(JSONSegment value, java.lang.Class&lt;T&gt; type)
    {
<span class="fc" id="L36">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="fc" id="L37">        PreCondition.assertNotNull(type, &quot;type&quot;);</span>

<span class="fc" id="L39">        return JSON.as(value, type, &quot;value&quot;);</span>
    }

    static &lt;T extends JSONSegment&gt; Result&lt;T&gt; asOrNull(JSONSegment value, java.lang.Class&lt;T&gt; type, String valueName)
    {
<span class="fc" id="L44">        PreCondition.assertNotNull(value, &quot;value&quot;);</span>
<span class="fc" id="L45">        PreCondition.assertNotNull(type, &quot;type&quot;);</span>
<span class="fc" id="L46">        PreCondition.assertNotNullAndNotEmpty(valueName, &quot;valueName&quot;);</span>

<span class="fc" id="L48">        return JSON.as(value, type)</span>
<span class="fc" id="L49">            .catchError(WrongTypeException.class, () -&gt; JSON.as(value, JSONNull.class).await())</span>
<span class="fc" id="L50">            .convertError(WrongTypeException.class, () -&gt; new WrongTypeException(JSON.getWrongTypeExceptionMessage(value, Iterable.create(type, JSONNull.class), valueName)));</span>
    }

    static Boolean toBooleanOrNull(JSONBoolean segment)
    {
<span class="fc bfc" id="L55" title="All 2 branches covered.">        return segment == null ? null : segment.getValue();</span>
    }

    static Double toNumberOrNull(JSONNumber segment)
    {
<span class="fc bfc" id="L60" title="All 2 branches covered.">        return segment == null ? null : segment.getValue();</span>
    }

    static String toStringOrNull(JSONString segment)
    {
<span class="fc bfc" id="L65" title="All 2 branches covered.">        return segment == null ? null : segment.getValue();</span>
    }

    /**
     * Parse a JSONSegment from the provided text.
     * @param text The text to parse into a JSONSegment.
     * @return The parsed JSONSegment.
     */
    static Result&lt;JSONSegment&gt; parse(String text)
    {
<span class="fc" id="L75">        PreCondition.assertNotNull(text, &quot;text&quot;);</span>

<span class="fc" id="L77">        return JSON.parse(Strings.iterable(text));</span>
    }

    /**
     * Parse a JSONSegment from the provided characters.
     * @param characters The characters to parse into a JSONSegment.
     * @return The parsed JSONSegment.
     */
    static Result&lt;JSONSegment&gt; parse(Iterable&lt;Character&gt; characters)
    {
<span class="fc" id="L87">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L89">        return JSON.parse(characters.iterate());</span>
    }

    /**
     * Parse a JSONSegment from the provided characters.
     * @param characters The characters to parse into a JSONSegment.
     * @return The parsed JSONSegment.
     */
    static Result&lt;JSONSegment&gt; parse(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L99">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L101">        return JSON.parse(JSON.createTokenizer(characters));</span>
    }

    /**
     * Parse a JSONSegment from the provided JSONTokenizer.
     * @param tokenizer The tokenizer that produces JSONTokens.
     * @return The parsed JSONSegment.
     */
    static Result&lt;JSONSegment&gt; parse(JSONTokenizer tokenizer)
    {
<span class="fc" id="L111">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc" id="L113">        return Result.create(() -&gt;</span>
        {
<span class="fc" id="L115">            JSON.ensureHasStarted(tokenizer);</span>

<span class="fc bfc" id="L117" title="All 2 branches covered.">            if (!tokenizer.hasCurrent())</span>
            {
<span class="fc" id="L119">                throw new ParseException(&quot;No JSON tokens found.&quot;);</span>
            }

            JSONSegment result;
<span class="fc bfc" id="L123" title="All 7 branches covered.">            switch (tokenizer.getCurrent().getType())</span>
            {
                case LeftCurlyBracket:
<span class="fc" id="L126">                    result = JSON.parseObject(tokenizer).await();</span>
<span class="fc" id="L127">                    break;</span>

                case LeftSquareBracket:
<span class="fc" id="L130">                    result = JSON.parseArray(tokenizer).await();</span>
<span class="fc" id="L131">                    break;</span>

                case Boolean:
<span class="fc bfc" id="L134" title="All 2 branches covered.">                    result = JSONBoolean.get(JSONToken.falseToken != JSON.takeCurrent(tokenizer));</span>
<span class="fc" id="L135">                    break;</span>

                case Null:
<span class="fc" id="L138">                    result = JSONNull.segment;</span>
<span class="fc" id="L139">                    JSON.next(tokenizer);</span>
<span class="fc" id="L140">                    break;</span>

                case Number:
<span class="fc" id="L143">                    result = JSONNumber.get(JSON.takeCurrent(tokenizer).getText());</span>
<span class="fc" id="L144">                    break;</span>

                case QuotedString:
<span class="fc" id="L147">                    result = JSONString.getFromQuoted(JSON.takeCurrent(tokenizer).getText());</span>
<span class="fc" id="L148">                    break;</span>

                default:
<span class="fc" id="L151">                    throw new ParseException(&quot;Unexpected JSON token: &quot; + tokenizer.getCurrent());</span>
            }

<span class="fc" id="L154">            PostCondition.assertNotNull(result, &quot;result&quot;);</span>

<span class="fc" id="L156">            return result;</span>
        });
    }

    /**
     * Parse a JSONObject from the provided text.
     * @param text The text to parse into a JSONObject.
     * @return The parsed JSONObject.
     */
    static Result&lt;JSONObject&gt; parseObject(String text)
    {
<span class="fc" id="L167">        PreCondition.assertNotNull(text, &quot;text&quot;);</span>

<span class="fc" id="L169">        return JSON.parseObject(Strings.iterable(text));</span>
    }

    /**
     * Parse a JSONObject from the provided characters.
     * @param characters The characters to parse into a JSONObject.
     * @return The parsed JSONObject.
     */
    static Result&lt;JSONObject&gt; parseObject(Iterable&lt;Character&gt; characters)
    {
<span class="fc" id="L179">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L181">        return JSON.parseObject(characters.iterate());</span>
    }

    /**
     * Parse a JSONObject from the provided characters.
     * @param characters The characters to parse into a JSONObject.
     * @return The parsed JSONObject.
     */
    static Result&lt;JSONObject&gt; parseObject(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L191">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L193">        return JSON.parseObject(JSON.createTokenizer(characters));</span>
    }

    /**
     * Parse a JSONObject from the provided JSONTokenizer.
     * @param tokenizer The tokenizer that produces JSONTokens.
     * @return The parsed JSONObject.
     */
    static Result&lt;JSONObject&gt; parseObject(JSONTokenizer tokenizer)
    {
<span class="fc" id="L203">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc" id="L205">        return Result.create(() -&gt;</span>
        {
<span class="fc bfc" id="L207" title="All 2 branches covered.">            if (!tokenizer.hasCurrent())</span>
            {
<span class="fc" id="L209">                throw new ParseException(&quot;Missing object left curly bracket ('{').&quot;);</span>
            }
<span class="fc bfc" id="L211" title="All 2 branches covered.">            else if (tokenizer.getCurrent().getType() != JSONTokenType.LeftCurlyBracket)</span>
            {
<span class="fc" id="L213">                throw new ParseException(&quot;Expected object left curly bracket ('{').&quot;);</span>
            }

<span class="fc" id="L216">            JSON.takeCurrent(tokenizer);</span>

<span class="fc" id="L218">            final List&lt;JSONProperty&gt; properties = List.create();</span>
<span class="fc" id="L219">            JSONToken rightCurlyBracket = null;</span>
<span class="fc" id="L220">            boolean expectProperty = true;</span>
<span class="fc bfc" id="L221" title="All 4 branches covered.">            while (tokenizer.hasCurrent() &amp;&amp; rightCurlyBracket == null)</span>
            {
<span class="fc bfc" id="L223" title="All 4 branches covered.">                switch (tokenizer.getCurrent().getType())</span>
                {
                    case QuotedString:
<span class="fc bfc" id="L226" title="All 2 branches covered.">                        if (!expectProperty)</span>
                        {
<span class="fc" id="L228">                            throw new ParseException(&quot;Expected object property separator (',') or right curly bracket ('}').&quot;);</span>
                        }
<span class="fc" id="L230">                        properties.add(JSON.parseObjectProperty(tokenizer).await());</span>
<span class="fc" id="L231">                        expectProperty = false;</span>
<span class="fc" id="L232">                        break;</span>

                    case Comma:
<span class="fc bfc" id="L235" title="All 2 branches covered.">                        if (expectProperty)</span>
                        {
<span class="fc bfc" id="L237" title="All 2 branches covered.">                            if (properties.any())</span>
                            {
<span class="fc" id="L239">                                throw new ParseException(&quot;Expected quoted-string object property name.&quot;);</span>
                            }
                            else
                            {
<span class="fc" id="L243">                                throw new ParseException(&quot;Expected quoted-string object property name or right curly bracket ('}').&quot;);</span>
                            }
                        }
<span class="fc" id="L246">                        JSON.next(tokenizer);</span>
<span class="fc" id="L247">                        expectProperty = true;</span>
<span class="fc" id="L248">                        break;</span>

                    case RightCurlyBracket:
<span class="fc bfc" id="L251" title="All 4 branches covered.">                        if (properties.any() &amp;&amp; expectProperty)</span>
                        {
<span class="fc" id="L253">                            throw new ParseException(&quot;Expected quoted-string object property name.&quot;);</span>
                        }
<span class="fc" id="L255">                        rightCurlyBracket = JSON.takeCurrent(tokenizer);</span>
<span class="fc" id="L256">                        break;</span>

                    default:
<span class="fc bfc" id="L259" title="All 2 branches covered.">                        if (properties.any())</span>
                        {
<span class="fc bfc" id="L261" title="All 2 branches covered.">                            if (expectProperty)</span>
                            {
<span class="fc" id="L263">                                throw new ParseException(&quot;Expected quoted-string object property name.&quot;);</span>
                            }
                            else
                            {
<span class="fc" id="L267">                                throw new ParseException(&quot;Expected object property separator (',') or right curly bracket ('}').&quot;);</span>
                            }
                        }
                        else
                        {
<span class="fc" id="L272">                            throw new ParseException(&quot;Expected quoted-string object property name or right curly bracket ('}').&quot;);</span>
                        }
                }
            }

<span class="fc bfc" id="L277" title="All 4 branches covered.">            if (properties.any() &amp;&amp; expectProperty)</span>
            {
<span class="fc" id="L279">                throw new ParseException(&quot;Missing object property.&quot;);</span>
            }
<span class="fc bfc" id="L281" title="All 2 branches covered.">            else if (rightCurlyBracket == null)</span>
            {
<span class="fc" id="L283">                throw new ParseException(&quot;Missing object right curly bracket ('}').&quot;);</span>
            }

<span class="fc" id="L286">            return JSONObject.create(properties);</span>
        });
    }

    /**
     * Parse a JSONObjectProperty from the provided text.
     * @param text The text to parse into a JSONObjectProperty.
     * @return The parsed JSONObjectProperty.
     */
    static Result&lt;JSONProperty&gt; parseObjectProperty(String text)
    {
<span class="fc" id="L297">        PreCondition.assertNotNull(text, &quot;text&quot;);</span>

<span class="fc" id="L299">        return JSON.parseObjectProperty(Strings.iterable(text));</span>
    }

    /**
     * Parse a JSONObjectProperty from the provided characters.
     * @param characters The characters to parse into a JSONObjectProperty.
     * @return The parsed JSONObjectProperty.
     */
    static Result&lt;JSONProperty&gt; parseObjectProperty(Iterable&lt;Character&gt; characters)
    {
<span class="fc" id="L309">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L311">        return JSON.parseObjectProperty(characters.iterate());</span>
    }

    /**
     * Parse a JSONObjectProperty from the provided characters.
     * @param characters The characters to parse into a JSONObjectProperty.
     * @return The parsed JSONObjectProperty.
     */
    static Result&lt;JSONProperty&gt; parseObjectProperty(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L321">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L323">        return JSON.parseObjectProperty(JSON.createTokenizer(characters));</span>
    }

    /**
     * Parse a JSONObjectProperty from the provided JSONTokenizer.
     * @param tokenizer The tokenizer that produces JSONTokens.
     * @return The parsed JSONObjectProperty.
     */
    static Result&lt;JSONProperty&gt; parseObjectProperty(JSONTokenizer tokenizer)
    {
<span class="fc" id="L333">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc" id="L335">        return Result.create(() -&gt;</span>
        {
<span class="fc bfc" id="L337" title="All 2 branches covered.">            if (!tokenizer.hasCurrent())</span>
            {
<span class="fc" id="L339">                throw new ParseException(&quot;Missing object property name.&quot;);</span>
            }
<span class="fc bfc" id="L341" title="All 2 branches covered.">            else if (tokenizer.getCurrent().getType() != JSONTokenType.QuotedString)</span>
            {
<span class="fc" id="L343">                throw new ParseException(&quot;Expected object property name.&quot;);</span>
            }

<span class="fc" id="L346">            final String quotedPropertyName = JSON.takeCurrent(tokenizer).getText();</span>
<span class="fc" id="L347">            final String propertyName = Strings.unquote(quotedPropertyName);</span>

<span class="fc bfc" id="L349" title="All 2 branches covered.">            if (!tokenizer.hasCurrent())</span>
            {
<span class="fc" id="L351">                throw new ParseException(&quot;Missing object property name and value separator (':').&quot;);</span>
            }
<span class="fc bfc" id="L353" title="All 2 branches covered.">            else if (tokenizer.getCurrent().getType() != JSONTokenType.Colon)</span>
            {
<span class="fc" id="L355">                throw new ParseException(&quot;Expected object property name and value separator (':').&quot;);</span>
            }

            JSONSegment propertyValue;
<span class="fc bfc" id="L359" title="All 2 branches covered.">            if (!JSON.next(tokenizer))</span>
            {
<span class="fc" id="L361">                throw new ParseException(&quot;Missing object property value.&quot;);</span>
            }
            else
            {
<span class="fc bfc" id="L365" title="All 3 branches covered.">                switch (tokenizer.getCurrent().getType())</span>
                {
                    case Comma:
<span class="fc" id="L368">                        throw new ParseException(&quot;Expected object property value.&quot;);</span>

                    case Boolean:
                    case Null:
                    case Number:
                    case QuotedString:
                    case LeftCurlyBracket:
                    case LeftSquareBracket:
<span class="fc" id="L376">                        propertyValue = JSON.parse(tokenizer).await();</span>
<span class="fc" id="L377">                        break;</span>

                    default:
<span class="fc" id="L380">                        throw new ParseException(&quot;Unexpected object property value token: &quot; + Strings.escapeAndQuote(tokenizer.getCurrent()));</span>
                }
            }

<span class="fc" id="L384">            return JSONProperty.create(propertyName, propertyValue);</span>
        });
    }

    /**
     * Parse a JSONArray from the provided text.
     * @param text The text to parse into a JSONArray.
     * @return The parsed JSONArray.
     */
    static Result&lt;JSONArray&gt; parseArray(String text)
    {
<span class="fc" id="L395">        PreCondition.assertNotNull(text, &quot;text&quot;);</span>

<span class="fc" id="L397">        return JSON.parseArray(Strings.iterable(text));</span>
    }

    /**
     * Parse a JSONArray from the provided characters.
     * @param characters The characters to parse into a JSONArray.
     * @return The parsed JSONArray.
     */
    static Result&lt;JSONArray&gt; parseArray(Iterable&lt;Character&gt; characters)
    {
<span class="fc" id="L407">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L409">        return JSON.parseArray(characters.iterate());</span>
    }

    /**
     * Parse a JSONArray from the provided characters.
     * @param characters The characters to parse into a JSONArray.
     * @return The parsed JSONArray.
     */
    static Result&lt;JSONArray&gt; parseArray(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L419">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L421">        return JSON.parseArray(JSON.createTokenizer(characters));</span>
    }

    /**
     * Parse a JSONArray from the provided JSONTokenizer.
     * @param tokenizer The tokenizer that produces JSONTokens.
     * @return The parsed JSONArray.
     */
    static Result&lt;JSONArray&gt; parseArray(JSONTokenizer tokenizer)
    {
<span class="fc" id="L431">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc" id="L433">        return Result.create(() -&gt;</span>
        {
<span class="fc bfc" id="L435" title="All 2 branches covered.">            if (!tokenizer.hasCurrent())</span>
            {
<span class="fc" id="L437">                throw new ParseException(&quot;Missing array left square bracket ('[').&quot;);</span>
            }
<span class="fc bfc" id="L439" title="All 2 branches covered.">            else if (tokenizer.getCurrent().getType() != JSONTokenType.LeftSquareBracket)</span>
            {
<span class="fc" id="L441">                throw new ParseException(&quot;Expected array left square bracket ('[').&quot;);</span>
            }

<span class="fc" id="L444">            JSON.takeCurrent(tokenizer);</span>

<span class="fc" id="L446">            final List&lt;JSONSegment&gt; elements = List.create();</span>

<span class="fc" id="L448">            JSONToken rightSquareBracket = null;</span>
<span class="fc" id="L449">            boolean expectElement = true;</span>
<span class="fc bfc" id="L450" title="All 4 branches covered.">            while (tokenizer.hasCurrent() &amp;&amp; rightSquareBracket == null)</span>
            {
<span class="fc bfc" id="L452" title="All 4 branches covered.">                switch (tokenizer.getCurrent().getType())</span>
                {
                    case Boolean:
                    case Null:
                    case Number:
                    case QuotedString:
                    case LeftCurlyBracket:
                    case LeftSquareBracket:
<span class="fc bfc" id="L460" title="All 2 branches covered.">                        if (!expectElement)</span>
                        {
<span class="fc" id="L462">                            throw new ParseException(&quot;Expected array element separator (',') or right square bracket (']').&quot;);</span>
                        }
<span class="fc" id="L464">                        elements.add(JSON.parse(tokenizer).await());</span>
<span class="fc" id="L465">                        expectElement = false;</span>
<span class="fc" id="L466">                        break;</span>

                    case Comma:
<span class="fc bfc" id="L469" title="All 2 branches covered.">                        if (expectElement)</span>
                        {
<span class="fc" id="L471">                            throw new ParseException(&quot;Expected array element.&quot;);</span>
                        }
<span class="fc" id="L473">                        JSON.next(tokenizer);</span>
<span class="fc" id="L474">                        expectElement = true;</span>
<span class="fc" id="L475">                        break;</span>

                    case RightSquareBracket:
<span class="fc bfc" id="L478" title="All 4 branches covered.">                        if (elements.any() &amp;&amp; expectElement)</span>
                        {
<span class="fc" id="L480">                            throw new ParseException(&quot;Expected array element.&quot;);</span>
                        }
<span class="fc" id="L482">                        rightSquareBracket = JSON.takeCurrent(tokenizer);</span>
<span class="fc" id="L483">                        expectElement = false;</span>
<span class="fc" id="L484">                        break;</span>

                    default:
<span class="fc" id="L487">                        throw new ParseException(&quot;Unexpected array element token: &quot; + Strings.escapeAndQuote(tokenizer.getCurrent()));</span>
                }
            }

<span class="fc bfc" id="L491" title="All 4 branches covered.">            if (elements.any() &amp;&amp; expectElement)</span>
            {
<span class="fc" id="L493">                throw new ParseException(&quot;Missing array element.&quot;);</span>
            }
<span class="fc bfc" id="L495" title="All 2 branches covered.">            else if (rightSquareBracket == null)</span>
            {
<span class="fc" id="L497">                throw new ParseException(&quot;Missing array right square bracket (']').&quot;);</span>
            }

<span class="fc" id="L500">            return JSONArray.create(elements);</span>
        });
    }

    static JSONTokenizer createTokenizer(Iterator&lt;Character&gt; characters)
    {
<span class="fc" id="L506">        PreCondition.assertNotNull(characters, &quot;characters&quot;);</span>

<span class="fc" id="L508">        final JSONTokenizer result = JSONTokenizer.create(characters);</span>
<span class="fc" id="L509">        JSON.next(result);</span>

<span class="fc" id="L511">        PostCondition.assertNotNull(result, &quot;result&quot;);</span>
<span class="fc" id="L512">        PostCondition.assertTrue(result.hasStarted(), &quot;result.hasStarted()&quot;);</span>

<span class="fc" id="L514">        return result;</span>
    }

    static boolean shouldSkipCurrentToken(JSONTokenizer tokenizer)
    {
<span class="fc" id="L519">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>
<span class="fc" id="L520">        PreCondition.assertTrue(tokenizer.hasCurrent(), &quot;tokenizer.hasCurrent()&quot;);</span>

        boolean result;
<span class="fc bfc" id="L523" title="All 2 branches covered.">        switch (tokenizer.getCurrent().getType())</span>
        {
            case BlockComment:
            case LineComment:
            case NewLine:
            case Whitespace:
<span class="fc" id="L529">                result = true;</span>
<span class="fc" id="L530">                break;</span>

            default:
<span class="fc" id="L533">                result = false;</span>
                break;
        }

<span class="fc" id="L537">        return result;</span>
    }

    static boolean next(JSONTokenizer tokenizer)
    {
<span class="fc" id="L542">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc" id="L544">        boolean result = tokenizer.next();</span>
<span class="fc bfc" id="L545" title="All 4 branches covered.">        while (result &amp;&amp; JSON.shouldSkipCurrentToken(tokenizer))</span>
        {
<span class="fc" id="L547">            result = tokenizer.next();</span>
        }

<span class="fc" id="L550">        return result;</span>
    }

    static void ensureHasStarted(JSONTokenizer tokenizer)
    {
<span class="fc" id="L555">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>

<span class="fc bfc" id="L557" title="All 6 branches covered.">        if (!tokenizer.hasStarted() || (tokenizer.hasCurrent() &amp;&amp; JSON.shouldSkipCurrentToken(tokenizer)))</span>
        {
<span class="fc" id="L559">            JSON.next(tokenizer);</span>
        }

<span class="fc" id="L562">        PostCondition.assertTrue(tokenizer.hasStarted(), &quot;tokenizer.hasStarted()&quot;);</span>
<span class="fc" id="L563">    }</span>

    static JSONToken takeCurrent(JSONTokenizer tokenizer)
    {
<span class="fc" id="L567">        PreCondition.assertNotNull(tokenizer, &quot;tokenizer&quot;);</span>
<span class="fc" id="L568">        PreCondition.assertTrue(tokenizer.hasCurrent(), &quot;tokenizer.hasCurrent()&quot;);</span>

<span class="fc" id="L570">        final JSONToken result = tokenizer.getCurrent();</span>
<span class="fc" id="L571">        JSON.next(tokenizer);</span>

<span class="fc" id="L573">        return result;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.4.201905082037</span></div></body></html>